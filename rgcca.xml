<tool id="multiOmics_Toolbox" name="multiOmics_Toolbox" version="1.0">

    <description>performs multi-variate analysis (PCA, CCA, PLS, RGCCA) and projects the variables and samples into a bi-dimensional space </description>

<!--    <macros>
        <import>macros.xml</import>
    </macros>-->


    <command ><![CDATA[
        #set $data_paths = $block_1.file_name
        #set $data_names = $block_1.name
        #for $i, $s in enumerate( $dataset )
            #set $data_paths += ',' + $s.block_n.file_name
            #set $data_names += ',' + $s.block_n.name
        #end for
        Rscript $__tool_directory__/galaxy_rgcca.R
             -d "${$data_paths}"
             -n "${$data_names}"
             --output1 $samples_space --output2 $variables_space --output3 $best_biomarkers
    ]]></command>

    <stdio>
        <exit_code range="1" level="fatal" description="" />
    </stdio>

    <inputs>
    <param name="block_1" type="data" format="tsv,tabular,txt,csv" label="Dataset"
           help="File containing a matrix with the samples in lines (should be labelled) and variables in columns (should have an header)." />
    <repeat name="dataset" title="New dataset"
            help="Additional dataset with a different structure than the first one. Each dataset will be analysed separately.
            Expected format is a file containing a matrix with the samples in lines (should be labelled) and variables in columns
            (should have an header)" >
        <param name="block_n" type="data" format="tsv,tabular,txt,csv" label="Dataset" />
    </repeat>

    </inputs>

    <outputs>
        <data name="samples_space" label="samples_space.pdf" format="pdf" />
        <data name="variables_space" label="variables_space.pdf" format="pdf" />
        <data name="best_biomarkers"  label="best_biomarkers.pdf" format="pdf" />
    </outputs>

    <help>

    </help>


</tool>
